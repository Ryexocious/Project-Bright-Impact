<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.StackPane?>

<VBox spacing="8" alignment="TOP_CENTER" styleClass="main-container"
      xmlns="http://javafx.com/javafx/23.0.1"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="controller.ElderDashboardController"
      stylesheets="@../styles/elderdash.css">

    <padding>
        <Insets top="8" right="12" bottom="8" left="12"/>
    </padding>

    <!-- Top Row: Welcome + Emergency on top-right -->
    <HBox spacing="12" VBox.vgrow="NEVER" style="-fx-alignment: center-left;">
        <VBox spacing="3" alignment="CENTER_LEFT" HBox.hgrow="ALWAYS">
            <Label fx:id="welcomeLabel" text="Welcome, ..." styleClass="welcome-text-compact"/>
        </VBox>

        <Region HBox.hgrow="ALWAYS"/>

        <!-- Emergency button top-right -->
        <Button fx:id="helpRequestButton" text="EMERGENCY HELP"
                onAction="#handleHelpRequest"
                styleClass="emergency-button-compact"/>
    </HBox>

    <!-- Main Content Row -->
    <HBox spacing="12" VBox.vgrow="ALWAYS" style="-fx-alignment: top-center;">
        <!-- Left: Upcoming Medicines (card) -->
        <VBox spacing="8" styleClass="upcoming-medicines-section-compact" HBox.hgrow="ALWAYS" prefWidth="450.0">
            <HBox spacing="5" alignment="CENTER_LEFT">
                <Label text="Upcoming Medicines" styleClass="section-title-compact"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Button fx:id="viewMedicineButton" text="View All Medicines" onAction="#handleViewMedicine"
                        styleClass="view-button-compact"/>
            </HBox>

            <VBox fx:id="medsListBox" spacing="8" styleClass="upcoming-medicines-flow-compact" VBox.vgrow="ALWAYS">
                <!-- medicine list populated by controller -->
            </VBox>

            <VBox spacing="5" alignment="CENTER" fx:id="noUpcomingMedicinesCard" visible="false" managed="false"
                  styleClass="no-medicines-card-compact">
                <Label text="No upcoming medicines scheduled" styleClass="no-medicines-text-compact"/>
            </VBox>
        </VBox>

        <!-- Right: Actions card (now used to host the circular timer) -->
        <VBox spacing="8" styleClass="navigation-section-compact actions-section" prefWidth="450.0" HBox.hgrow="NEVER">
            <Label text="Clock" styleClass="nav-title-compact"/>
            <!-- Injected timer will appear here -->
            <StackPane fx:id="timerHost" prefWidth="340" prefHeight="340" style="-fx-alignment: center;"/>
            <!-- Optional intake status + confirm button -->
            <Label fx:id="nextDoseLabel" text="Next dose at: --:--" style="-fx-font-size: 14px; -fx-text-fill: #666;"/>
            <Label fx:id="intakeStatusLabel" text="" style="-fx-font-size: 12px; -fx-text-fill: #c62828;"/>
            <Button fx:id="confirmIntakeButton" text="Confirm intake âœ…" onAction="#handleConfirmIntake" visible="false"
                    style="-fx-font-size: 16px; -fx-background-color: #2ecc71; -fx-text-fill: white;"/>
        </VBox>
    </HBox>

    <!-- Bottom Row: Sign Out -->
    <HBox spacing="5" alignment="CENTER" styleClass="logout-section-compact" VBox.vgrow="NEVER">
        <Button fx:id="logoutButton" text="Sign Out" onAction="#handleLogout" styleClass="logout-button-compact"/>
    </HBox>
</VBox>
